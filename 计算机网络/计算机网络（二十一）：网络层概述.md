![在这里插入图片描述](https://img-blog.csdnimg.cn/2020051820260933.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQwODUxNzQ0,size_16,color_FFFFFF,t_70)
一个具有H1、H2两台主机和在H1与H2之间的路径上有几台路由器的简单网络。假设H1正在向H2发送信息，H1中的网络层取得来自于H1运输层的报文段，将每个报文段封装成一个数据报(即一个网络层的分组)，然后将该数据报向相邻路由器R1发送。在接收方主机H2，网络层接收来自相邻路由器R2的数据报，提取出运输层报文段，并将其向上交付给H2出的运输层。路由辑的主要作用便是将数据报从输入链路转发到输出链路。
注意路由器具有截断的协议钱，即没有网络层以上的部分，因为(除了控制目的外)路由器不运行应用层和运输层协议，没有必要。
1、转发和路由选择
网络层需要两个重要的网络层功能：
a、转发：当一个分组到达路由器的一条输入链路时，路由器必须将该分组移动到适当的输出链路。
b、路由选择：当分组从发送方流向接收方时，网络层必须决定这些分组所采用的路由或路径。计算这些路径的算法被称为路由选择算法。
转发是指将分组从一个输入链路接口转移到适当的输出链路接口的路由器本地动作。类似于转弯。
路由选择是指网络范围的过程，以决定分组从源到目的地所采取的端到端路径。类似于看地图找路线。
每台路由器具有一张转发表。路由器通过检查到达分组首部字段的值来转发分组，然后使用该值在该路由器的转发表中索引查询。存储在转发表项中的该首部的值指出了该分组将被转发的路由器的输出链路接口。分组首部中的该值可能是该分组的目的地址或该分组所属连接的指示，这取决于网络层协议。
路由器的转发表揭示了路由选择和转发间的重要相互作用关系。路由选择算法决定了插入路由器的转发表中的值。路由选择算法可能是集中式的，或是分布式的。在任何一种情况下，都是路由器接收路由选择协议报文，该信息被用于配置其转发表。
分组交换机是指一台通用分组交换设备，它根据分组首部字段中的值，从输入链路接口到输出链路接口转移分组。某些分组交换机称为链路层交换机，基于链路层字段中的值做转发决定。其他分组交换机称为路由器，基于网络层字段中的值做转发决定。
c、连接建立：某些网络层体系结构要求从源到目的地沿着所选择的路径彼此握手，以便在给定源到目的地连接中的网络层数据分组能够开始流动之前建立起状态。
2、网络服务模型
网络服务模型定义了分组在发送与接收端系统之间的端到端运输特性。
网络层提供的特定服务包括：
①、确保交付：确保分组将最终到达其目的地
②、具有延时上届的确保交付：不仅确保分组的交付，而且在特定的主机到主机时延上界内交付。
③、有序分组交付：确保分组以他们发送的顺序到达目的地
④、确保最小带宽：模仿在发送和接收主机之间的一条特定比特率的传输链路的行为。只要发送主机以低于特定比特率的速率传输比特(作为分组的组成部分)，则分组不会丢失，且每个分组会在预定的主机到主机时延内到达。
⑤、确保最大时延抖动：确保位于发送方的两个相继分组之间的时间量等于在目的地接收到它们之间的时间量。
⑥、安全性服务：使用仅由源和目的主机所知晓的一个秘密会话密钥，在源主机中的网络层能够加密向目的主机发送的所有数据报负载。在目的主机中的网络层则能够负责解密该负载。使用这种服务，能够向源和目的主机之间的所有运输层报文段提供机密性。除了机密性以外，网络层能够提供数据完整性和源鉴别服务。
因特网的网络层提供了单一的服务，称为尽力而为服务。分组间的定时是不能确保被保证的，分组接收的顺序也不能保证与发送的顺序一致，传送的分组也不能保证最终交付。简单地讲，因特网的网络层就是最简单的一种。
