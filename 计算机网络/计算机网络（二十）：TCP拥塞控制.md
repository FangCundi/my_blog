TCP必须使用端到端拥塞控制而不是使网络辅助的拥塞控制，因为IP层不向端系统提供显式的网络拥塞反馈。
TCP所采用的方法是让每一个发送方根据所感知到的网络拥塞程度来限制其能向连接发送流量的速率。如果一个TCP发送方感知从它到目的地之间的路径上没什么拥塞，则TCP发送方增加其发送速率；如果发送方感知沿着该路径有拥塞，则发送方就会降低其发送速率。
发送方的发送速率大概是cwnd/RTT字节/秒。通过调节cwnd（拥塞窗口）的值，发送方因此能调整它向连接发送数据的速率。
当出现过度的拥塞时，在沿着这条路径上的一台(或多台)路由器的缓存会溢出，引起一个数据报(包含一个TCP报文段)被丢弃。丢弃的数据报接着会引起发送方的丢包事件(要么超时或收到3个冗余ACK)，发送方就认为在发送方到接收方的路径上出现了拥塞的指示。
如果没有出现丢包事件，TCP的发送方将收到对于以前未确认报文段的确认。此时就可以通过这个确认来改变窗口的长度。如果确认以相当慢的速率到达，则该拥塞窗口将以相当慢的速率增加；如果确认以高速率到达，则该拥塞窗口将会更为迅速地增大。因为TCP使用确认来触发(或计时)增大它的拥塞窗口长度，TCP 被说成是自计时。
如何确定发送速率，既使得网络不会拥塞，与此同时又能充分利用所有可用的带宽？有三个原则：
①、一个丢失的报文段表意味着拥塞，因此当丢失报文段时应当降低TCP发送方的速率。
②、一个确认报文段指示该网络正在向接收方交付发送方的报文段，因此，当对先前未确认报文段的确认到达时，能够增加发送方的速率。
③、带宽检测。给定ACK指示源到目的地路径无拥塞，而丢包事件指示路径拥塞，TCP调节其传输速率的策略是增加其速率以响应到达的ACK，除非出现丢包事件，此时才减小传输速率。
TCP发送方的行为类似于要求越来越多糖果的孩子，直到最后告知他/她"不行!"，孩子后退一点，然后过一会儿再次开始提出请求。
注意到网络中没有明确的拥塞状态信令，即ACK和丢包事件充当了隐式信号，并且每个TCP发送方根据异步于其他TCP发送方的本地信息而行动。
**TCP拥塞控制算法有三个部分，即慢启动、拥塞避免、快速恢复。其中慢启动和拥塞避免是强制的，而快速恢复是可选的**。

### a、慢启动：

当一条TCP连接开始时，cwnd（拥塞窗口）的值通常初始置为MSS的较小值，这就使得初始发送速率大约为 MSS/RTT。
因此，在慢启动状态，cwnd的值以MSS开始并且每当传输的报文段首次被确认就增加一个MSS。如下
![在这里插入图片描述](https://img-blog.csdnimg.cn/20200428173816416.png)

TCP向网络发送第一个报文段并等待一个确认。当该确认到达时，TCP发送方将拥塞窗口增加一个MSS，并发送出两个最大长度的报文。这两个报文段被确认，则发送方对每个确认报文段将拥塞窗口增加一个MSS，使得拥塞窗口变为4个MSS，并这样下去。这一过程每过一个RTT，发送速率就翻一番。因此，TCP发送速率起始慢，但在慢启动阶段以指数增长。
慢启动有两种结束方式：一种是当遇到一个由超时指示的丢包事件（发生了拥塞），就会将cwnd重新设置为1并重新开始慢启动过程。另一种是当当前cwnd为上次拥塞时的cwnd的一半的时候，就会不再进行二倍。
**简单地讲，就是每当正常传输的时候，就在下次发送两倍的分组，直到发生了超时然后重新开始，或者达到了一个阈值**。

### b、拥塞避免：

一旦进入拥塞避免状态，cwnd的值大约是上次遇到拥塞时的值的一半，而此时无法在通过对每一个RTT再将cwnd的值翻番，于是选择每个RTT只将cwnd的值增加一个MSS。
一种通用的方法是对于TCP发送方无论何时到达一个新的确认，就将cwnd增加一个MSS字节。
当出现超时时，TCP的拥塞避免算法行为相同与慢启动的情况一样，cwnd 的值被设置为1MSS，当丢包事件出现时，ssthresh的值被更新为cwnd值的一半。**即更加精确，更加靠近最大的窗口数**。

### c、快速恢复：

在快速恢复中，对于引起TCP进入快速恢复状态的缺失报文段，对收到的每个冗余的ACK, cwnd的值增加一个MSS。最终，当对丢失报文段的一个ACK到达时，TCP在降低cwnd后进入拥塞避免状态。如果出现超时事件，快速恢复在执行如同在慢启动和拥塞避免中相同的动作后，迁移到慢启动状态:当丢包事件出现时，cwnd 的值被设置为1MSS，并且ssthresh（即拥塞窗口阈值）的值设置为cwnd值的一半。
**简单地讲，就是先对cwnd进行增加，增加的数值为冗余ACK的数量，然后进入拥塞避免状态。**
**可以看出来，TCP的主要思路是通过“重启”的思路进行控制，通过一次一次的重启，来得到最接近于最大拥塞窗口的一个参数，而这个参数就代表了我们的流水线传输中可以在链路上可以传输的最大分组数目，然后在这个参数下进行传输。**
TCP的拥塞控制是:首先通过慢启动得到比较接近最大拥塞窗口的数值（每个RTT内cwnd翻番），然后每个RTT内cwnd线性(加性)增加1MSS，然后出现3个冗余ACK 事件时，cwnd 减半(乘性减)。因此，TCP拥塞控制常常被称为加性增、乘性拥塞控制方式（AIMD）。TCP线性地增加它的拥塞窗口长度(因此增加其传输速率)，直到出现3个冗余ACK。然后以2个因子来减少它的拥塞窗口长度，然后又开始了线性增长，探测是否还有另外的可用带宽。
![在这里插入图片描述](https://img-blog.csdnimg.cn/20200428173912959.png)
